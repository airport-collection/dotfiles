#!/usr/bin/env zsh

setopt localoptions err_return

[[ $# -eq 1 ]] || echo 'Usage: vimode [mode]'

function send-notification() {
  notify-send 'vimode' "$1"
}

function normal() {
  xkb-switch -s 'us(vimnormal)'
  xbindkeys -fg ~/.xbindkeysrc.vimnormal.scm
  send-notification 'normal'
}

function insert() {
  xkb-switch -s 'us(viminsert)'
  xbindkeys
  send-notification 'insert'
}

killall xbindkeys 2>&1 > /dev/null
$1
